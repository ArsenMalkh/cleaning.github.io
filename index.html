<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Upload and Preview Images with Delete Option</title>
    <style>
        .image-container {
            position: relative;
            display: inline-block;
            margin: 5px;
        }
        .uploaded-image {
            width: 100px; /* Adjust as needed */
            height: auto;
        }
        .delete-button {
            position: absolute;
            top: 0;
            right: 0;
            color: white;
            background-color: red;
            cursor: pointer;
            padding: 0 5px;
        }
    </style>
</head>
<body>

<div>
    <label for="fileToUpload">Take or select photo(s)</label><br />
    <input type="file" id="fileToUpload" onchange="fileSelected();" accept="image/*" multiple />
</div>
<div id="imagePreview"></div>
<div>
    <button onclick="uploadFiles()">Upload</button>
</div>

<script>
var selectedFiles = []; // Store selected files

function fileSelected() {
    var files = document.getElementById('fileToUpload').files;
    var imagePreview = document.getElementById('imagePreview');

    Array.from(files).forEach((file) => {
        selectedFiles.push(file);

        var fileId = selectedFiles.length - 1; // File ID is its index in the array

        var reader = new FileReader();
        var imageContainer = document.createElement('div');
        imageContainer.classList.add('image-container');

        reader.onload = function (e) {
            var img = document.createElement('img');
            img.src = e.target.result;
            img.classList.add('uploaded-image');

            var deleteButton = document.createElement('span');
            deleteButton.innerHTML = 'x';
            deleteButton.classList.add('delete-button');
            deleteButton.onclick = function () {
                imageContainer.remove();
                delete selectedFiles[fileId]; // Remove file from the array
            };

            imageContainer.appendChild(img);
            imageContainer.appendChild(deleteButton);
            imagePreview.appendChild(imageContainer);
        };

        reader.readAsDataURL(file);
    });

    document.getElementById('fileToUpload').value = ""; // Clear the input
}

function uploadFiles() {
    var formData = new FormData();
    selectedFiles.forEach((file, index) => {
        if (file) { // Check if the file wasn't deleted
            formData.append('fileToUpload[]', file, file.name);
        }
    });

    fetch('Upload.aspx', { // Replace 'Upload.aspx' with your actual upload URL
        method: 'POST',
        body: formData
    })
    .then(response => response.text())
    .then(result => {
        console.log(result); // Handle the server response here
    })
    .catch(error => {
        console.error('Error:', error);
    });
}
</script>

</body>
</html>
